<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 500" width="900" height="500">
  <defs>
    <linearGradient id="bgGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#1a1a2e;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#16213e;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="boxGradient" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#2d3748;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#1a202c;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="accentGradient" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#4ade80;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#22c55e;stop-opacity:1" />
    </linearGradient>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="0" dy="2" stdDeviation="3" flood-color="#000" flood-opacity="0.3"/>
    </filter>
  </defs>

  <!-- Background -->
  <rect width="900" height="500" fill="#0f0f23"/>

  <!-- Title -->
  <text x="450" y="35" text-anchor="middle" font-family="Arial, sans-serif" font-size="20" font-weight="bold" fill="#4ade80">claude-memo 系统架构</text>

  <!-- Layer 1: CLI -->
  <rect x="50" y="60" width="800" height="70" rx="8" fill="url(#boxGradient)" filter="url(#shadow)"/>
  <text x="450" y="95" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#f8fafc">CLI (clap)</text>
  <text x="450" y="115" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#94a3b8">main.rs / cli.rs</text>

  <!-- Arrow down -->
  <path d="M450 130 L450 155" stroke="#4ade80" stroke-width="2" marker-end="url(#arrowhead)"/>
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#4ade80"/>
    </marker>
  </defs>

  <!-- Layer 2: Parser -->
  <rect x="50" y="160" width="800" height="70" rx="8" fill="url(#boxGradient)" filter="url(#shadow)"/>
  <text x="450" y="195" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#f8fafc">Parser (解析层)</text>
  <text x="450" y="215" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#94a3b8">parse_history_file() - 解析 history.jsonl / Record 结构体</text>

  <!-- Arrow split -->
  <path d="M450 230 L250 280" stroke="#4ade80" stroke-width="2"/>
  <path d="M450 230 L650 280" stroke="#4ade80" stroke-width="2"/>
  <polygon points="255,275 245,285 260,285" fill="#4ade80"/>
  <polygon points="645,275 655,285 640,285" fill="#4ade80"/>

  <!-- Layer 3: Indexer & Storage -->
  <rect x="50" y="285" width="350" height="100" rx="8" fill="url(#boxGradient)" filter="url(#shadow)"/>
  <text x="225" y="320" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#f8fafc">Indexer (索引)</text>
  <text x="225" y="340" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#94a3b8">FTS5 索引构建 / 增量更新</text>
  <rect x="80" y="355" width="290" height="20" rx="4" fill="#1e3a5f"/>
  <text x="225" y="369" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#4ade80">sessions.db (SQLite FTS5)</text>

  <rect x="500" y="285" width="350" height="100" rx="8" fill="url(#boxGradient)" filter="url(#shadow)"/>
  <text x="675" y="320" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#f8fafc">Storage (收藏存储)</text>
  <text x="675" y="340" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#94a3b8">add_favorite() / remove_favorite() / list_favorites()</text>
  <rect x="530" y="355" width="290" height="20" rx="4" fill="#1e3a5f"/>
  <text x="675" y="369" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#4ade80">sessions.toml (TOML)</text>

  <!-- Arrow split 2 -->
  <path d="M225 385 L225 420" stroke="#4ade80" stroke-width="2"/>
  <path d="M675 385 L675 420" stroke="#4ade80" stroke-width="2"/>
  <polygon points="220,415 230,415 225,425" fill="#4ade80"/>
  <polygon points="670,415 680,415 675,425" fill="#4ade80"/>

  <!-- Layer 4: Search & Output -->
  <rect x="50" y="425" width="350" height="60" rx="8" fill="url(#boxGradient)" filter="url(#shadow)"/>
  <text x="225" y="455" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#f8fafc">Search (搜索)</text>
  <text x="225" y="475" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#94a3b8">BM25 排序 / FTS5 查询</text>

  <rect x="500" y="425" width="350" height="60" rx="8" fill="url(#boxGradient)" filter="url(#shadow)"/>
  <text x="675" y="455" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#f8fafc">Output (输出)</text>
  <text x="675" y="475" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#94a3b8">文本格式 / JSON 格式</text>

  <!-- Legend -->
  <rect x="50" y="60" width="15" height="15" fill="url(#accentGradient)" rx="2"/>
  <text x="75" y="72" font-family="Arial, sans-serif" font-size="10" fill="#94a3b8">核心组件</text>

  <rect x="160" y="60" width="15" height="15" fill="url(#boxGradient)" rx="2" stroke="#4ade80" stroke-width="1"/>
  <text x="185" y="72" font-family="Arial, sans-serif" font-size="10" fill="#94a3b8">处理模块</text>

  <rect x="260" y="60" width="15" height="15" fill="#1e3a5f" rx="2"/>
  <text x="285" y="72" font-family="Arial, sans-serif" font-size="10" fill="#94a3b8">数据存储</text>
</svg>
